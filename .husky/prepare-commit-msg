#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

BRANCH=$(git symbolic-ref --short HEAD)

# main ë¸Œëœì¹˜ì¼ ê²½ìš°ì—” ì‹¤í–‰ X
if [ "$BRANCH" = "main" ]; then
  exit 0
fi

# ì»¤ë°‹ ë©”ì‹œì§€ íŒŒì¼ ì½ê¸°
COMMIT_MSG_FILE=$1
COMMIT_MSG=$(cat "$COMMIT_MSG_FILE")

# ì»¤ë°‹ íƒ€ì…ì— ë”°ë¥¸ ì´ëª¨í‹°ì½˜ ë§¤í•‘ ë° íƒ€ì… ì•ì— ì¶”ê°€
if [[ "$COMMIT_MSG" =~ ^feat ]]; then
  MODIFIED_MSG=$(echo "$COMMIT_MSG" | sed 's/^feat/âœ¨ feat/')
elif [[ "$COMMIT_MSG" =~ ^fix ]]; then
  MODIFIED_MSG=$(echo "$COMMIT_MSG" | sed 's/^fix/ğŸ› fix/')
elif [[ "$COMMIT_MSG" =~ ^docs ]]; then
  MODIFIED_MSG=$(echo "$COMMIT_MSG" | sed 's/^docs/ğŸ“š docs/')
elif [[ "$COMMIT_MSG" =~ ^style ]]; then
  MODIFIED_MSG=$(echo "$COMMIT_MSG" | sed 's/^style/ğŸ’„ style/')
elif [[ "$COMMIT_MSG" =~ ^refactor ]]; then
  MODIFIED_MSG=$(echo "$COMMIT_MSG" | sed 's/^refactor/â™»ï¸ refactor/')
elif [[ "$COMMIT_MSG" =~ ^test ]]; then
  MODIFIED_MSG=$(echo "$COMMIT_MSG" | sed 's/^test/ğŸ§ª test/')
elif [[ "$COMMIT_MSG" =~ ^chore ]]; then
  MODIFIED_MSG=$(echo "$COMMIT_MSG" | sed 's/^chore/ğŸ”§ chore/')
else
  MODIFIED_MSG="$COMMIT_MSG" # ë§¤ì¹­ë˜ëŠ” íƒ€ì…ì´ ì—†ìœ¼ë©´ ê·¸ëŒ€ë¡œ ìœ ì§€
fi

# ìˆ˜ì •ëœ ë©”ì‹œì§€ë¡œ ë®ì–´ì“°ê¸°
echo "$MODIFIED_MSG" > "$COMMIT_MSG_FILE"

# ì§€ë¼ íƒœìŠ¤í¬ ë²ˆí˜¸ ì¶”ê°€
pnpm jira-prepare-commit-msg $1