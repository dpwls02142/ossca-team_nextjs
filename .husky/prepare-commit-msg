#!/usr/bin/env bash

BRANCH=$(git symbolic-ref --short HEAD)

# main ë¸Œëžœì¹˜ì¼ ê²½ìš°ì—” ì‹¤í–‰ X
if [ "$BRANCH" = "main" ]; then
  exit 0
fi

# ì»¤ë°‹ ë©”ì‹œì§€ íŒŒì¼ ì½ê¸°
COMMIT_MSG_FILE=$1
COMMIT_MSG=$(cat "$COMMIT_MSG_FILE")

# ì»¤ë°‹ íƒ€ìž…ì— ë”°ë¥¸ ì´ëª¨í‹°ì½˜ ë§¤í•‘ ë° íƒ€ìž… ì•žì— ì¶”ê°€
if echo "$COMMIT_MSG" | grep -q "^feat"; then
  MODIFIED_MSG=$(echo "$COMMIT_MSG" | sed 's/^feat/âœ¨ feat/')
elif echo "$COMMIT_MSG" | grep -q "^fix"; then
  MODIFIED_MSG=$(echo "$COMMIT_MSG" | sed 's/^fix/ðŸ› fix/')
elif echo "$COMMIT_MSG" | grep -q "^docs"; then
  MODIFIED_MSG=$(echo "$COMMIT_MSG" | sed 's/^docs/ðŸ“š docs/')
elif echo "$COMMIT_MSG" | grep -q "^style"; then
  MODIFIED_MSG=$(echo "$COMMIT_MSG" | sed 's/^style/ðŸ’„ style/')
elif echo "$COMMIT_MSG" | grep -q "^refactor"; then
  MODIFIED_MSG=$(echo "$COMMIT_MSG" | sed 's/^refactor/â™»ï¸ refactor/')
elif echo "$COMMIT_MSG" | grep -q "^test"; then
  MODIFIED_MSG=$(echo "$COMMIT_MSG" | sed 's/^test/ðŸ§ª test/')
elif echo "$COMMIT_MSG" | grep -q "^chore"; then
  MODIFIED_MSG=$(echo "$COMMIT_MSG" | sed 's/^chore/ðŸ”§ chore/')
else
  MODIFIED_MSG="$COMMIT_MSG" # ë§¤ì¹­ë˜ëŠ” íƒ€ìž…ì´ ì—†ìœ¼ë©´ ê·¸ëŒ€ë¡œ ìœ ì§€
fi

# ìˆ˜ì •ëœ ë©”ì‹œì§€ë¡œ ë®ì–´ì“°ê¸°
echo "$MODIFIED_MSG" > "$COMMIT_MSG_FILE"

# jira-prepare-commit-msg ì‹¤í–‰
npx --no -- jira-prepare-commit-msg "$COMMIT_MSG_FILE"